!function(e){function t(t){for(var r,o,c=t[0],l=t[1],u=t[2],f=0,d=[];f<c.length;f++)o=c[f],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&d.push(a[o][0]),a[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(s&&s(t);d.length;)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var l=n[c];0!==a[l]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var s=l;i.push([378,1]),n()}({220:function(e,t,n){},358:function(e,t,n){},378:function(e,t,n){"use strict";n.r(t);n(220);var r=n(0),a=n(23),i=n(22),o=n.n(i),c=n(17),l=n.n(c),u=n(21),s=n.n(u),f=n(8),d=n.n(f),p=n(12),m=n.n(p),v=n(110),h=n.n(v);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y={"Change in Storage":{url:"https://utility.arcgis.com/usrsvcs/servers/a26157d5bcc144678aeac6a73549eb85/rest/services/GLDAS_StorageChange/ImageServer",mosaicRule:{where:"tag = 'Composite'",ascending:!1}},Runoff:{url:"https://utility.arcgis.com/usrsvcs/servers/ad5f6cdf01e3448588a293d94ef3bd50/rest/services/GLDAS_Runoff/ImageServer",mosaicRule:{where:"tag = 'Composite'",ascending:!1,multidimensionalDefinition:[{variableName:"Total Runoff (mm)"}]}},"Soil Moisture":{url:"https://utility.arcgis.com/usrsvcs/servers/f520544817274518afa7ce71e7bfa715/rest/services/GLDAS_SoilMoisture/ImageServer",mosaicRule:{where:"tag = 'Composite'",ascending:!1,multidimensionalDefinition:[{variableName:"Total Soil Moisture 0 to 200cm (mm)"}]}},Precipitation:{url:"https://utility.arcgis.com/usrsvcs/servers/0b0823aec0e44abc9df288e2e97bd6fa/rest/services/GLDAS_Precipitation/ImageServer",mosaicRule:{where:"tag = 'Composite'",ascending:!1,multidimensionalDefinition:[{variableName:"Total Precipitation (mm)"}]}},Evapotranspiration:{url:"https://utility.arcgis.com/usrsvcs/servers/8152741eb29d4cdb8f4661f21b6c2fcd/rest/services/GLDAS_Evapotranspiration/ImageServer",mosaicRule:{where:"tag = 'Composite'",ascending:!1}},Snowpack:{url:"https://utility.arcgis.com/usrsvcs/servers/0d6a500cd4cc41bfa5f4eb2d1a7899a1/rest/services/GLDAS_Snowpack/ImageServer",mosaicRule:{where:"tag = 'Composite'",ascending:!1}}},E={"Change in Storage":b(b({},y["Change in Storage"]),{},{url:"https://utilitydevext.arcgis.com/sharing/servers/f511627378ee49ee9c495b674e4c8fc2/rest/services/GLDAS_StorageChange/ImageServer"}),Runoff:b(b({},y.Runoff),{},{url:"https://utilitydevext.arcgis.com/sharing/servers/3d0579583dbd46909903dec46ba2fa77/rest/services/GLDAS_Runoff/ImageServer"}),"Soil Moisture":b(b({},y["Soil Moisture"]),{},{url:"https://utilitydevext.arcgis.com/sharing/servers/cc648ec9c40342cc805be9b1d07184e9/rest/services/GLDAS_SoilMoisture/ImageServer"}),Precipitation:b(b({},y.Precipitation),{},{url:"https://utilitydevext.arcgis.com/sharing/servers/21aee7a24ceb4104bf1cad1b868df72d/rest/services/GLDAS_Precipitation/ImageServer"}),Evapotranspiration:b(b({},y.Evapotranspiration),{},{url:"https://utilitydevext.arcgis.com/sharing/servers/e462322a598c47d38cde5c01b75bc054/rest/services/GLDAS_Evapotranspiration/ImageServer"}),Snowpack:b(b({},y.Snowpack),{},{url:"https://utilitydevext.arcgis.com/sharing/servers/88ae6caa9efc433fbfe4342dc7d7a21e/rest/services/GLDAS_Snowpack/ImageServer"})};function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=Object.keys(y),S=[],j="livingatlasdev.arcgis.com"===location.host?E:y,k=function(){var e=s()(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j.Snowpack.url+"/multiDimensionalInfo?f=json",e.prev=1,e.next=4,h.a.get(t);case 4:return n=e.sent,r=n.data&&n.data.multidimensionalInfo&&n.data.multidimensionalInfo.variables&&n.data.multidimensionalInfo.variables[0]&&n.data.multidimensionalInfo.variables[0].dimensions&&n.data.multidimensionalInfo.variables[0].dimensions[0]&&n.data.multidimensionalInfo.variables[0].dimensions[0].values?n.data.multidimensionalInfo.variables[0].dimensions[0].values:[],S=r.map((function(e){return new Date(e)})),e.abrupt("return",S);case 10:e.prev=10,e.t0=e.catch(1);case 13:return e.abrupt("return",[]);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=s()(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S&&S.length){e.next=3;break}return e.next=3,k();case 3:return n={geometry:{x:t.longitude,y:t.latitude,spatialReference:{wkid:4326}},returnGeometry:"false",returnCatalogItems:"true",renderingRule:{rasterFunction:"None"},geometryType:"esriGeometryPoint",f:"json"},r=O.map((function(e){var t=j[e];return h.a.get(t.url+"/identify",{params:x(x({},n),{},{mosaicRule:t.mosaicRule})})})),e.abrupt("return",new Promise((function(e,t){Promise.all(r).then((function(n){n[0].data&&"NoData"===n[0].data.value&&t({error:"failed to fetch GLDAS data"});for(var r={},a=0,i=n.length;a<i;a++){var o=O[a],c=n[a],l=c.data&&c.data.properties&&c.data.properties.Values&&c.data.properties.Values.length?c.data.properties.Values:null;r[o]=P(l)}var u=M(r);e({identifyResults:r,identifyResultsByMonth:u})})).catch((function(e){t(e.message)}))})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){var t=[];return e.forEach((function(e){var n=e.split(" ").map((function(e){return+e}));t=t.concat(n)})),t.map((function(e,t){return{date:S[t],value:e}}))},M=function(e){for(var t={},n=function(n,r){var a=S[n].getMonth();O.forEach((function(r){var i=e[r][n];t[r]||(t[r]=[]),t[r][a]||(t[r][a]=[]),t[r][a].push(i)}))},r=0,a=S.length;r<a;r++)n(r);return t},D=n(170),I=r.createContext(null),R=function(e){var t=e.children,n=r.useState([]),a=d()(n,2),i=a[0],o=a[1],c=function(){var e=s()(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:t=e.sent,o(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u={timeExtentForGldasLayers:i,isMobile:D.miscFns.isMobileDevice()};return r.useEffect((function(){c()}),[]),r.createElement(I.Provider,{value:u},t)},L=n(171),z=n.n(L),N=function(e){var t=r.useState(),n=d()(t,2),a=n[0],i=n[1],o=r.useState(!1),c=d()(o,2),u=c[0],f=c[1],p=r.useState(!1),m=d()(p,2),v=m[0],h=m[1],g=function(){var t=s()(l.a.mark((function t(){var n,r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f(!0),h(!1),t.prev=2,t.next=5,C(e);case 5:n=t.sent,r=n.identifyResults,a=n.identifyResultsByMonth,i({gldasData:r,gldasDataByMonth:a}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),h(!0),i(null);case 15:f(!1);case 16:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(){return t.apply(this,arguments)}}();return r.useEffect((function(){e&&g()}),[e]),{gldasDataResponse:a,isLoading:u,isFailed:v,resetIsFailed:function(){h(!1)}}},A="2ba2fc7bba774ff481c8233b2e01c433",T="LLL u",F=50,G=260,_="#0079c1",B="#a6deff",W="#5984ca",H="#598fb8",V="#f9f9f9",U="#b15a4d",q="rgba(84, 39, 136, .8)",Y="rgba(127, 39, 4, .8)",J="rgba(207, 34, 171, 0.8)",X="rgba(255, 255, 255, 0.7)",K=function(e){z()(e);var t=r.useContext(I),n=t.timeExtentForGldasLayers,a=t.isMobile,i=r.useState("Soil Moisture"),o=d()(i,2),c=o[0],l=o[1],u=r.useState(),s=d()(u,2),f=s[0],p=s[1],m=r.useState(),v=d()(m,2),h=v[0],g=v[1],b=r.useState(),y=d()(b,2),E=y[0],w=y[1],x=N(E),O=x.gldasDataResponse,S=x.isLoading,j=x.isFailed,k=x.resetIsFailed,C=r.useState(!1),P=d()(C,2),M=P[0],D=P[1],R=function(){return O&&!j&&!a};return r.useEffect((function(){if(n.length){var e=n.length-1,t=n[e];p({index:e,date:t})}}),[n]),f?r.createElement(r.Fragment,null,r.createElement(le,{infoIconOnClick:D.bind(void 0,!0)}),r.createElement(Z,{paddingBottom:R()?G:0,onClickHandler:w},r.createElement(se,{layerName:c,selectedTimeExtentItem:f}),r.createElement(Qt,{geometry:E}),r.createElement($,{onSelect:w}),r.createElement(ye,{activeLayer:c,onChange:l})),function(){if(!R())return null;var e=O.gldasData,t=O.gldasDataByMonth;return(r.createElement(ke,{isLoading:S,isMobile:a},r.createElement(Lt,{data:e,gldasDataByMonth:t,timeExtentItem:h||f}),r.createElement(Et,{data:e,gldasDataByMonth:t,timeExtentItem:h||f}),r.createElement(ut,{data:e,timeExtent:n,activeLayer:c,selectedTimeExtentItem:f,previewTimeExtentItem:h,selectedItemOnChange:p,previewItemOnChange:g}),r.createElement(Kt,{data:t,timeExtentItem:h||f,activeLayer:c})))}(),r.createElement(rn,{isOpen:M,onClose:D.bind(void 0,!1)}),r.createElement(cn,{isVisible:a}),r.createElement(ln,{isVisible:j,onClose:k})):null},Q=n(29),Z=function(e){var t=e.paddingBottom,n=e.onClickHandler,a=e.children,i=r.useRef(),o=r.useState(null),c=d()(o,2),u=c[0],f=c[1],p=function(){var e=s()(l.a.mark((function e(){var t,n,r,a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Q.loadModules)(["esri/views/MapView","esri/WebMap"]);case 3:t=e.sent,n=d()(t,2),r=n[0],a=n[1],(o=new r({container:i.current,map:new a({portalItem:{id:A}}),padding:{top:F}})).when((function(){f(o)})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return r.useEffect((function(){Object(Q.loadCss)(),p()}),[]),r.useEffect((function(){u&&u.on("click",(function(e){n&&n(e.mapPoint)}))}),[u]),r.createElement(r.Fragment,null,r.createElement("div",{style:{position:"absolute",top:0,left:0,bottom:t||0,width:"100%"},ref:i}),r.Children.map(a,(function(e){return r.cloneElement(e,{mapView:u})})))},$=function(e){var t=e.onSelect,n=e.mapView,a=void 0===n?null:n,i=function(){var e=s()(l.a.mark((function e(){var n,r,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Q.loadModules)(["esri/widgets/Search"]);case 3:n=e.sent,r=d()(n,1),i=r[0],(o=new i({view:a,popupEnabled:!1,resultGraphicEnabled:!1})).on("search-complete",(function(e){var n,r,a,i=null==e?void 0:null===(n=e.results[0])||void 0===n?void 0:null===(r=n.results[0])||void 0===r?void 0:null===(a=r.feature)||void 0===a?void 0:a.geometry;t(i)})),a.ui.add(o,{position:"top-right",index:2}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return r.useEffect((function(){a&&i()}),[a]),null},ee=n(11),te=n.n(ee),ne=n(5),re=n(49);function ae(){var e=te()(["\n    margin: 0;\n    padding-right: .75rem;\n    margin-right: .75rem;\n    border-right: 1px solid rgba(255,255,255,.75);\n"]);return ae=function(){return e},e}function ie(){var e=te()(["\n    position: relative;\n    display: flex;\n    align-items: center;\n    height: ",";\n    width: 100%;\n    box-sizing: border-box;\n    padding: .25rem 1rem;\n    z-index: 5;\n    background: ",";\n    color: #fff;\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);\n"]);return ie=function(){return e},e}var oe=ne.default.div(ie(),F+"px",_),ce=Object(ne.default)(re.CalciteH4)(ae()),le=function(e){var t=e.infoIconOnClick;return(r.createElement(oe,null,r.createElement(ce,null,"Water Balance App"),r.createElement("div",null,r.createElement("span",{className:"font-size--2 tablet-hide margin-right-half"},"Click anywhere on earth to see how the water balance is changing over time"),r.createElement("span",{className:"font-size--1 icon-ui-question cursor-pointer",onClick:t}))))},ue=n(382),se=function(e){var t=e.layerName,n=e.selectedTimeExtentItem,a=e.mapView,i=void 0===a?null:a,o=function(){var e=s()(l.a.mark((function e(){var t,r,a,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(Q.loadModules)(["esri/TimeExtent"]);case 4:t=e.sent,r=d()(t,1),a=r[0],o=new Date(n.date),u=Object(ue.a)(o,{days:1}),i.timeExtent=new a({start:o,end:u}),c();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){t&&n&&i&&i.map.layers.forEach((function(e){e.visible=e.title===t}))};return r.useEffect((function(){i&&n&&o()}),[i]),r.useEffect((function(){o()}),[n]),r.useEffect((function(){c()}),[t]),null},fe=n(44),de=n.n(fe),pe=n(172),me=n.n(pe),ve=n(107);function he(){var e=te()(["\n    position: absolute;\n    top: 10px;\n    left: 60px;\n    width: 198px;\n    background-color: ",";\n    color: #fff;\n    z-index: 5;\n"]);return he=function(){return e},e}var ge=[{key:de.a.generate(),value:"Soil Moisture"},{key:de.a.generate(),value:"Snowpack"},{key:de.a.generate(),value:"Precipitation"},{key:de.a.generate(),value:"Evapotranspiration"},{key:de.a.generate(),value:"Runoff"},{key:de.a.generate(),value:"Change in Storage"}],be=Object(ne.default)(me.a)(he(),_),ye=function(e){var t=e.activeLayer,n=e.onChange;return r.createElement(be,{onChange:n,selectedValue:t},ge.map((function(e){var t=e.key,n=e.value;return(r.createElement(ve.MenuItem,{key:t,value:n},n))})))},Ee=n(179),we=n.n(Ee);function xe(){var e=te()(["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n"]);return xe=function(){return e},e}function Oe(){var e=te()(["\n    position: absolute;\n    display: flex;\n    bottom: 0;\n    left: 0;\n    box-sizing: border-box;\n    width: 100%;\n    height: ",";\n    padding: .75rem;\n    box-shadow: 0 -5px 5px -5px rgba(0,0,0,.4);\n    background-color: ",";\n"]);return Oe=function(){return e},e}var Se=ne.default.div(Oe(),G+"px",B),je=ne.default.div(xe()),ke=function(e){var t=e.isLoading,n=(e.isMobile,e.children);return r.createElement(Se,null,t?r.createElement(je,null,r.createElement(we.a,{text:"Loading..."})):n)},Ce=n(2),Pe=function(){var e=r.useState([0,0]),t=d()(e,2),n=t[0],a=t[1];return r.useLayoutEffect((function(){var e=function(){a([window.innerWidth,window.innerHeight])};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n},Me=n(180),De=n.n(Me),Ie=n(381),Re={"Soil Moisture":"#7aa5c6",Snowpack:"#f9f9f9",Precipitation:"#6990cf",Runoff:"#c07a70",Evapotranspiration:"#c07a70","Change in Storage":"#fff"},Le=function(e){var t=e.svgContainerData,n=e.scales,a=e.itemOnHover,i=e.data,o=e.activeLayer,c=r.useRef(),l=r.useState({top:0,left:0}),u=d()(l,2),s=u[0],f=u[1];return r.useEffect((function(){!function(){var e=c.current;if(e){var r=t.dimension,i=t.margin,o=r.width,l=n.x,u=e.offsetWidth,s=-(e.offsetHeight-i.top-_e),d=l(a.date)+i.left,p=d+u>=o+i.left?d-u:d;f({top:s,left:p})}}()}),[a]),a?function(){var e=s.top,t=s.left,n=function(){if(!a||!i)return null;var e=a.index,t=a.date,n=[{key:"Soil Moisture",value:i["Soil Moisture"][e].value},{key:"Snowpack",value:i.Snowpack[e].value},{key:"Change in Storage",value:i["Change in Storage"][e].value},{key:"Precipitation",value:i.Precipitation[e].value},{key:"Runoff",value:i.Runoff[e].value},{key:"Evapotranspiration",value:i.Evapotranspiration[e].value}];return"Soil Moisture"===o||"Snowpack"===o?{date:t,items:n.filter((function(e){return"Soil Moisture"===e.key||"Snowpack"===e.key}))}:"Change in Storage"===o?{date:t,items:n.filter((function(e){return"Change in Storage"===e.key}))}:"Precipitation"===o||"Runoff"===o?{date:t,items:n.filter((function(e){return"Precipitation"===e.key||"Runoff"===e.key}))}:{date:t,items:n.filter((function(e){return"Precipitation"===e.key||"Evapotranspiration"===e.key}))}}();if(!n)return null;var l=n.date,u=n.items.map((function(e,t){var n=e.key,a=e.value;return(r.createElement("div",{key:"".concat(n,"-").concat(t),className:"font-size--2",style:{color:Re[n]}},r.createElement("span",null,n,": ",a," mm")))}));return r.createElement("div",{ref:c,style:{position:"absolute",left:"".concat(t,"px"),top:"".concat(e,"px"),padding:"7px 10px",background:"rgba(0,0,0,.85)"}},r.createElement("div",{className:"padding-trailer-quarter trailer-quarter font-size--2 text-white",style:{borderBottom:"1px solid rgba(255,255,255,.75)"}},Object(Ie.a)(l,T)),u)}():null};function ze(){var e=te()(["\n\n    .narrow-show {\n        display: none;\n    }\n\n    @media (max-width: 1585px) {\n        .narrow-hide {\n            display: none;\n        }\n\n        .narrow-show {\n            display: inline-block;\n        }\n    }\n"]);return ze=function(){return e},e}function Ne(){var e=te()(["\n    font-size: .825rem;\n"]);return Ne=function(){return e},e}function Ae(){var e=te()(["\n    height: 12px;\n    width: 12px;\n    margin-right: .5rem;\n    background-color: ",";\n"]);return Ae=function(){return e},e}function Te(){var e=te()(["\n    margin: 0 .75rem;\n    display: flex;\n    align-items: center;\n"]);return Te=function(){return e},e}function Fe(){var e=te()(["\n    display: flex;\n    padding: 0 1rem;\n    flex-grow: 1;\n"]);return Fe=function(){return e},e}function Ge(){var e=te()(["\n    height: ",";\n    padding: 0 2rem;\n    display: flex;\n"]);return Ge=function(){return e},e}var _e=25,Be="* Use mousewheel to zoom; click to display map layer in the selected time.",We=ne.default.div(Ge(),_e+"px"),He=ne.default.div(Fe()),Ve=ne.default.div(Te()),Ue=ne.default.div(Ae(),(function(e){return e.color})),qe=ne.default.span(Ne()),Ye=ne.default.div(ze()),Je={"Soil Moisture":r.createElement(Ve,null,r.createElement(Ue,{color:Re["Soil Moisture"]}),r.createElement(qe,null,"Soil Moisture")),Snowpack:r.createElement(Ve,null,r.createElement(Ue,{color:Re.Snowpack}),r.createElement(qe,null,"Snowpack")),Precipitation:r.createElement(Ve,null,r.createElement(Ue,{color:Re.Precipitation}),r.createElement(qe,null,"Precipitation")),Runoff:r.createElement(Ve,null,r.createElement(Ue,{color:Re.Runoff}),r.createElement(qe,null,"Runoff")),Evapotranspiration:r.createElement(Ve,null,r.createElement(Ue,{color:Re.Evapotranspiration}),r.createElement(qe,null,"Evapotranspiration")),"Change in Storage":null},Xe=function(e){var t=e.activeLayer;return r.createElement(We,null,r.createElement("div",null,r.createElement("span",{className:"avenir-demi font-size--2"},"Soil Moisture"===t||"Snowpack"===t?"Water Storage":"Change in Storage"===t?"Change in Storage":"Water Flux")),"Soil Moisture"===t||"Snowpack"===t?r.createElement(He,null,Je["Soil Moisture"],Je.Snowpack):"Change in Storage"===t?r.createElement(He,null):"Evapotranspiration"===t?r.createElement(He,null,Je.Precipitation,Je.Evapotranspiration):r.createElement(He,null,Je.Precipitation,Je.Runoff),r.createElement(Ye,null,r.createElement("span",{className:"font-size--3 narrow-hide"},Be),r.createElement(De.a,{title:Be,placement:"top"},r.createElement("span",{className:"icon-ui-question narrow-show"}))))};function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ze={top:20,right:30,bottom:20,left:40},$e=function(e){var t=e.timeExtent,n=e.yDomain,a=void 0===n?[0,0]:n,i=e.children,o=r.useRef(),c=r.useRef(),l=r.useState(),u=d()(l,2),s=u[0],f=u[1],p=r.useState(),m=d()(p,2),v=m[0],h=m[1],g=Pe(),b=function(){h((function(e){return Qe(Qe({},e),{},{lastUpdateTime:new Date})}))},y=function(e){var t=c.current,n=t.height,r=t.width,a=[[Ze.left,Ze.top],[r,n-Ze.top]];e.call(Object(Ce.p)().scaleExtent([1,4]).translateExtent(a).extent(a).on("zoom",E))},E=function(){var e=[0,c.current.width].map((function(e){return Ce.f.transform.applyX(e)}));v.x.range(e),v.xScaleBand.range([e[0],e[1]]),b()};return r.useEffect((function(){!function(){var e=o.current,n=e.offsetWidth-Ze.left-Ze.right,r=e.offsetHeight-Ze.top-Ze.bottom;c.current={height:r,width:n},Object(Ce.n)(e).append("svg").attr("width","100%").attr("height",r+Ze.top+Ze.bottom).append("g").attr("transform","translate(".concat(Ze.left,", ").concat(Ze.top,")"));var i=Object(Ce.n)(e).select("svg"),l=(i.select("g").append("clipPath").attr("id","gldasChartClip").append("rect").attr("width",n).attr("height",r),i.node()),u=i.select("g").node(),s=[t[0],t[t.length-1]],d=Object(Ce.m)().range([0,n]).domain(s),p=Object(Ce.k)().paddingInner(.2).range([0,n]).domain(t.map((function(e){return e.getTime()}))),m=Object(Ce.l)().range([r,0]).domain(a);f({svg:l,g:u,margin:Ze,clipPathId:"gldasChartClip",dimension:c.current}),h({x:d,y:m,xScaleBand:p})}()}),[]),r.useEffect((function(){!function(){var e=o.current;if(e&&s&&v){var t=v.x,n=v.xScaleBand,r=e.offsetWidth-Ze.left-Ze.right;c.current.width=r,Object(Ce.n)("#".concat("gldasChartClip")).select("rect").attr("width",r),t.range([0,r]),n.range([0,r]),b()}}()}),[g]),r.useEffect((function(){if(v&&s){var e=s.svg;Object(Ce.n)(e).call(y)}}),[v,s]),r.useEffect((function(){v&&a&&(v.y.domain(a).nice(),b())}),[a]),r.createElement(r.Fragment,null,r.createElement("div",{ref:o,style:{position:"relative",width:"100%",height:"calc(100% - ".concat(_e,"px)")}}),r.Children.map(i,(function(e){return r.cloneElement(e,{svgContainerData:s,scales:v})})))},et=(n(358),function(e){var t=e.svgContainerData,n=e.scales;return r.useEffect((function(){var e,r,a,i,o,c,l;t&&n&&(e=t.dimension,r=t.g,t.clipPathId,a=e.height,i=Object(Ce.n)(r),o=n.x,c=Object(Ce.b)(o).tickSizeInner(-a).tickPadding(7),(l=i.selectAll(".x.axis")).size()?l.attr("transform","translate(0,"+a+")").call(c):i.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(c),function(){var e=t.g,r=t.dimension.width,a=n.y,i=Object(Ce.n)(e),o=Object(Ce.c)(a).ticks(9).tickSizeInner(-r).tickPadding(5),c=i.selectAll(".y.axis");c.size()?c.call(o):i.append("g").attr("class","y axis").call(o)}())}),[t,n]),null}),tt=function(e){var t=e.data,n=e.svgContainerData,a=e.scales,i=r.useRef(),o=function(){var e=n.clipPathId,r=a.x,o=a.y,l=t["Soil Moisture"].map((function(e,n){var r=e.value;return{date:e.date,"Soil Moisture":r,Snowpack:t.Snowpack[n].value}})),u=Object(Ce.o)().keys(["Soil Moisture","Snowpack"])(l),s=Object(Ce.a)().x((function(e){return r(e.data.date)})).y0((function(e){return o(e[0])})).y1((function(e){return o(e[1])}));c(),Object(Ce.n)(i.current).append("g").attr("class","water-storage-path-group").attr("clip-path","url(#".concat(e,")")).selectAll("path").data(u).join("path").attr("fill",(function(e){return"Soil Moisture"===e.key?H:V})).attr("d",s)},c=function(){var e=Object(Ce.n)(i.current).select(".".concat("water-storage-path-group"));e.size()&&e.remove()};return r.useEffect((function(){var e;n&&(e=n.g,i.current=Object(Ce.n)(e).append("g").node())}),[n]),r.useEffect((function(){n&&a&&t&&o()}),[a]),r.useEffect((function(){n&&a&&(t?o():c())}),[t]),null},nt=function(e){var t=e.data,n=e.isDiverging,a=e.svgContainerData,i=e.scales,o=r.useRef(),c=function(){var e=a.dimension,r=a.clipPathId,c=e.height,u=i.xScaleBand,s=i.y;l(),Object(Ce.n)(o.current).append("g").attr("class","precip-rect-group").attr("clip-path","url(#".concat(r,")")).selectAll(".".concat("precip-rect")).data(t).enter().append("rect").attr("class","precip-rect").style("fill",(function(e){return n?e.value>=0?q:Y:W})).attr("x",(function(e){return u(e.date.getTime())})).attr("width",u.bandwidth()).attr("y",(function(e){return s(n?Math.max(0,e.value):e.value)})).attr("height",(function(e){return n?Math.abs(s(e.value)-s(0)):c-s(e.value)}))},l=function(){var e=Object(Ce.n)(o.current).selectAll(".".concat("precip-rect-group"));e.size()&&e.remove()};return r.useEffect((function(){var e;a&&(e=a.g,o.current=Object(Ce.n)(e).append("g").node())}),[a]),r.useEffect((function(){a&&i&&t&&c()}),[i]),r.useEffect((function(){a&&i&&(t?c():l())}),[t]),null},rt=function(e){var t=e.data,n=e.svgContainerData,a=e.scales,i=r.useRef(),o=function(){var e=n.clipPathId,r=Object(Ce.n)(i.current),o=a.x,l=a.y,u=a.xScaleBand.bandwidth()/2,s=Object(Ce.g)().curve(Ce.e).x((function(e){return o(e.date)-u})).y((function(e){return l(e.value)}));c(),r.append("path").data([t]).attr("class","water-flux-line").attr("clip-path","url(#".concat(e,")")).attr("d",s).style("fill","none").style("stroke","#fff").style("stroke-width",4).style("opacity",.8),r.append("path").data([t]).attr("class","water-flux-line").attr("clip-path","url(#".concat(e,")")).attr("d",s).style("fill","none").style("stroke",U).style("stroke-width",2)},c=function(){var e=Object(Ce.n)(i.current).selectAll(".".concat("water-flux-line"));e.size()&&e.remove().exit()};return r.useEffect((function(){var e;n&&(e=n.g,i.current=Object(Ce.n)(e).append("g").node())}),[n]),r.useEffect((function(){n&&a&&t&&o()}),[a]),r.useEffect((function(){n&&a&&(t?o():c())}),[t]),null},at=function(e){var t=e.timeExtent,n=e.svgContainerData,a=e.scales,i=e.onClick,o=e.onHover,c=r.useRef(),l=r.useRef(),u=function(e){l.current=e,f(),o(e)},s=function(e){i(e)},f=function(){var e=a.xScaleBand,t=l.current,n=Object(Ce.n)(c.current).select(".".concat("vertical-ref-line")),r=t?e(t.date.getTime())+e.bandwidth()/2:0,i=t?1:0;n.attr("x1",r).attr("x2",r).style("opacity",i)},d=function(e){for(var n=-1,r=a.x,i=0,o=t.length;i<o;i++){var c=r(t[i]),l=t[i+1]?i+1:i,u=r(t[l]);if(e>=c&&e<=u){n=Math.abs(e-c)<Math.abs(e-u)?i:l;break}}return{date:t[n],index:n}};return r.useEffect((function(){n&&t.length&&function(){var e=n.g,t=n.dimension,r=t.height,a=t.width;c.current=Object(Ce.n)(e).append("g").node();var i=Object(Ce.n)(c.current);i.append("line").attr("class","vertical-ref-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",r).style("opacity",0).attr("stroke-width",.5).attr("stroke","#fff").style("fill","none"),i.append("rect").attr("width",a).attr("height",r).attr("fill","rgba(0,0,0,0)").on("click",(function(){s(l.current)})).on("mouseleave",(function(){u(null)})).on("mousemove",(function(){var e=Object(Ce.j)(this)[0];u(d(e))}))}()}),[n,t]),r.useEffect((function(){if(n&&a){var e=n.dimension.width;Object(Ce.n)(c.current).select("rect").attr("width",e)}}),[a]),null},it=function(e){var t=e.activeTime,n=e.svgContainerData,a=e.scales,i=r.useRef();return r.useEffect((function(){n&&function(){var e=n.g,t=n.dimension,r=(n.clipPathId,t.height);i.current=Object(Ce.n)(e).append("g").node();var a=Object(Ce.n)(i.current);a.append("line").attr("class","active-time-indicator-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",r).style("opacity",1).attr("stroke-width",.5).attr("stroke","rgb(160, 0, 0)").style("fill","none"),a.append("rect").attr("width",60).attr("height",20).attr("transform","translate(-30, -20)").attr("class","active-time-indicator-rect").style("fill","rgb(160, 0, 0)"),a.append("text").attr("class","active-time-indicator-text").attr("dy","-5").attr("text-anchor","middle").style("font-size",".75rem").style("fill","#fff")}()}),[n]),r.useEffect((function(){t&&a&&function(){if(t){var e=n.dimension,r=a.xScaleBand,o=Object(Ce.n)(i.current),c=r(t.getTime())+r.bandwidth()/2;o.select(".".concat("active-time-indicator-text")).text(Object(Ie.a)(t,T)),o.attr("transform","translate(".concat(c,", 0)")).style("opacity",c<e.width?1:0)}}()}),[t,a]),null};function ot(){var e=te()(["\n    position: relative;\n    /* max-width: 1000px; */\n    flex-grow: 1;\n    flex-shrink: 1;\n    /* flex-basis: 600px; */\n    flex: auto;\n    height: 100%;\n"]);return ot=function(){return e},e}var ct={"Soil Moisture":"Water Storage",Snowpack:"Water Storage",Precipitation:"Water Flux",Evapotranspiration:"Water Flux",Runoff:"Water Flux","Change in Storage":"Change in Storage"},lt=ne.default.div(ot()),ut=function(e){var t=e.data,n=e.timeExtent,a=e.activeLayer,i=e.selectedTimeExtentItem,o=e.previewTimeExtentItem,c=e.selectedItemOnChange,l=e.previewItemOnChange;return r.createElement(lt,null,r.createElement(Xe,{activeLayer:a}),r.createElement($e,{timeExtent:n,yDomain:function(){if(!t)return[0,0];var e=ct[a];if("Water Storage"===e)return[0,Object(Ce.h)(t["Soil Moisture"].map((function(e){return e.value})))+Object(Ce.h)(t.Snowpack.map((function(e){return e.value})))];if("Change in Storage"===e){var n=t["Change in Storage"].map((function(e){return e.value}));return[Object(Ce.i)(n),Object(Ce.h)(n)]}var r=Object(Ce.h)(t.Precipitation.map((function(e){return e.value}))),i=Object(Ce.h)(t.Evapotranspiration.map((function(e){return e.value}))),o=Object(Ce.h)(t.Runoff.map((function(e){return e.value})));return[0,Object(Ce.h)([r,i,o])]}()},r.createElement(tt,{data:t&&"Water Storage"===ct[a]?{"Soil Moisture":t["Soil Moisture"],Snowpack:t.Snowpack}:null}),r.createElement(nt,{data:!t||"Water Flux"!==ct[a]&&"Change in Storage"!==ct[a]?null:"Change in Storage"===ct[a]?t["Change in Storage"]:t.Precipitation,isDiverging:"Change in Storage"===a}),r.createElement(rt,{data:t&&"Water Flux"===ct[a]?"Precipitation"===a||"Runoff"===a?t.Runoff:t.Evapotranspiration:null}),r.createElement(et,null),r.createElement(it,{activeTime:i.date}),r.createElement(at,{timeExtent:n,onHover:function(e){l(e)},onClick:function(e){c(e)}}),r.createElement(Le,{data:t,activeLayer:a,itemOnHover:o})))},st=n(113),ft=n.n(st),dt=function(e){return e.reduce((function(e,t){return e+t}),0)/e.length};function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vt(){var e=te()(["\n    border-bottom: 1px solid rgba(255,255,255,.5);\n    padding: .05rem 0;\n    display: flex;\n    justify-content: space-between;\n"]);return vt=function(){return e},e}function ht(){var e=te()(["\n    width: 230px;\n    flex-grow: 0;\n    flex-shrink: 0;\n    margin-right: 10px;\n"]);return ht=function(){return e},e}var gt=ne.default.div(ht()),bt=ne.default.div(vt()),yt={fontWeight:600},Et=function(e){var t,n,a=e.data,i=e.gldasDataByMonth,o=e.timeExtentItem,c=function(){var e=Object.keys(a),t=["Time"].concat(ft()(e.map((function(e){return e+" (mm)"})))),n=a.Precipitation.map((function(e){return e.date})),r="data:text/csv;charset=utf-8,";r+=t.join(","),r+="\r\n";for(var i=function(t,i){var o=e.map((function(e){return a[e][t].value})),c=[Object(Ie.a)(n[t],"MM/dd/u")].concat(ft()(o)).join(",");r+=c+"\r\n"},o=0,c=n.length;o<c;o++)i(o);var l=document.createElement("a");l.download="water-balance-data.csv",l.href=encodeURI(r),document.body.appendChild(l),l.click(),document.body.removeChild(l)};return a&&i&&o?r.createElement(gt,null,(n=o.date,r.createElement("div",{className:"text-center"},r.createElement("span",{className:"avenir-demi font-size--1"},Object(Ie.a)(n,T)))),(t=o.index,r.createElement("div",{className:"font-size--3"},r.createElement(bt,null,r.createElement("span",null,"Precipitation"),r.createElement("span",{style:mt(mt({},yt),{},{color:W})},a.Precipitation[t].value," mm")),r.createElement(bt,null,r.createElement("span",null,"Runoff"),r.createElement("span",{style:mt(mt({},yt),{},{color:U})},a.Runoff[t].value," mm")),r.createElement(bt,null,r.createElement("span",null,"Evapotranspiration"),r.createElement("span",{style:mt(mt({},yt),{},{color:U})},a.Evapotranspiration[t].value," mm")),r.createElement(bt,null,r.createElement("span",null,"Soil Moisture"),r.createElement("span",{style:mt(mt({},yt),{},{color:H})},a["Soil Moisture"][t].value," mm")),r.createElement(bt,null,r.createElement("span",null,"Snowpack"),r.createElement("span",{style:mt(mt({},yt),{},{color:"#fafafa"})},a.Snowpack[t].value," mm")))),function(){var e=o.index,t=o.date,n=t.getMonth(),c=a["Change in Storage"][e].value,l=r.createElement("span",{className:"avenir-demi",style:{color:c>=0?W:U}},c," mm"),u=a["Soil Moisture"][e].value,s=i["Soil Moisture"][n].map((function(e){return e.value})),f=dt(s),d=(u-f)/f*100,p=+Math.abs(d).toFixed(0),m=0===p?"about the average":"".concat(p,"% ").concat(d>=0?"above":"below"," average"),v=r.createElement("span",{className:"avenir-demi",style:{color:d>=0?W:U}},m);return r.createElement("p",{className:"font-size--3 leader-half trailer-half"},l," of water was ",c>=0?"recharged into":"depleted from"," storage this month. Total soil moisture is ",v," for ",Object(Ie.a)(t,"MMMM"),".")}(),r.createElement("p",{className:"font-size--3 trailer-0"},r.createElement("span",{className:"text-blue cursor-pointer",onClick:c},"Download")," water balance data as CSV")):null};function wt(){var e=te()(["\n    width: 0;\n    height: 0;\n    border-top: 5px solid transparent;\n    border-bottom: 5px solid transparent;\n    border-right: 5px solid #129876;\n    margin-right: .15rem;\n"]);return wt=function(){return e},e}function xt(){var e=te()(["\n    width: 100%;\n    height: 3px;\n    background-color: #303030;\n"]);return xt=function(){return e},e}function Ot(){var e=te()(["\n    font-size: 11px;\n"]);return Ot=function(){return e},e}function St(){var e=te()(["\n    position: relative;\n    background: linear-gradient(to top, #67001f 0%, #b2182b 10%, #d6604d 20%, #f4a582 30%, #d1e5f0 50%, #92c5de 70%, #4393c3 80%, #2166ac 90%, #053061 100%);\n    flex-grow: 1;\n    width: 25px;\n"]);return St=function(){return e},e}function jt(){var e=te()(["\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n"]);return jt=function(){return e},e}function kt(){var e=te()(["\n    height: 100%;\n    width: 70px;\n    flex-grow: 0;\n    flex-shrink: 0;\n    margin-right: 10px;\n"]);return kt=function(){return e},e}var Ct=ne.default.div(kt()),Pt=ne.default.div(jt()),Mt=ne.default.div(St()),Dt=ne.default.span(Ot()),It=ne.default.div(xt()),Rt=ne.default.div(wt()),Lt=function(e){var t,n,a,i,o,c,l=e.data,u=e.gldasDataByMonth,s=e.timeExtentItem,f=function(){var e=l["Change in Storage"].map((function(e){return e.value})),t=Object(Ce.h)(e);return{min:Object(Ce.i)(e),max:t}};return l&&u?r.createElement(Ct,null,r.createElement(Pt,null,r.createElement(Dt,null,"Recharge"),r.createElement(Mt,null,(t=s.index,n=l["Change in Storage"][t].value,a=f(),i=a.min,o=a.max,c=n>=0?(100-n/o*100)/2:100-(100-100*Math.abs(n/i))/2,r.createElement("div",{style:{position:"absolute",top:c+"%",width:"100%"}},r.createElement(It,null)))),r.createElement(Dt,null,"Depletion")),function(){var e=s.date.getMonth(),t=dt(u["Change in Storage"][e].map((function(e){return e.value}))),n=f(),a=n.min,i=50+t/(n.max-a)*100-6;return r.createElement("div",{style:{position:"absolute",top:i+"%",left:"35px",width:"50px",color:"#129876",display:"flex",alignItems:"center"}},r.createElement(Rt,null),r.createElement(Dt,null,"Normal"))}()):null},zt=function(e){var t=e.svgContainerData,n=e.scales;return r.useEffect((function(){var e,r,a,i,o,c;t&&n&&(e=t.height,r=t.g,a=Object(Ce.n)(r),i=n.x,o=Object(Ce.b)(i).tickSizeInner(-e).tickValues(i.domain().filter((function(e){return!(e%2)}))).tickFormat((function(e){var t=e.toString().split("");return t.slice(t.length-2).join("")})),(c=a.selectAll(".x.axis")).size()?c.attr("transform","translate(0,"+e+")").call(o):a.append("g").attr("class","x axis").attr("transform","translate(0,"+e+")").call(o),function(){var e=t.g,r=t.width,a=n.y,i=Object(Ce.n)(e),o=Object(Ce.c)(a).ticks(9).tickSizeInner(-r).tickPadding(5),c=i.selectAll(".y.axis");c.size()?c.call(o):i.append("g").attr("class","y axis").call(o)}())}),[t,n]),null};function Nt(){var e=te()(["\n    height: ",";\n    padding: 0 1rem;\n    display: flex;\n    justify-content: space-between;\n"]);return Nt=function(){return e},e}var At=ne.default.div(Nt(),"25px"),Tt=function(e){var t=e.activeLayer,n=e.timeExtentItem;return r.createElement(At,null,r.createElement("div",{className:"font-size--2"},r.createElement("span",{className:"margin-right-half"},"Trend Analyzer for ",r.createElement("span",{className:"avenir-demi"},t))),n?r.createElement("div",null,Object(Ie.a)(n.date,"MMMM")):null)};function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _t(){var e=te()(["\n    position: relative;\n    width: 100%;\n    height: ",";\n"]);return _t=function(){return e},e}var Bt=ne.default.div(_t(),(function(e){return"calc(100% - ".concat(e.headerHeight,"px)")})),Wt={top:15,right:30,bottom:20,left:40},Ht=function(e){var t=e.xDomain,n=e.yDomain,a=e.children,i=r.useRef(),o=r.useRef(),c=r.useState(),l=d()(c,2),u=l[0],s=l[1],f=r.useState(),p=d()(f,2),m=p[0],v=p[1],h=function(){v((function(e){return Gt(Gt({},e),{},{lastUpdateTime:new Date})}))};return r.useEffect((function(){!function(){var e=i.current,r=e.offsetWidth-Wt.left-Wt.right,a=e.offsetHeight-Wt.top-Wt.bottom;o.current={height:a,width:r},Object(Ce.n)(e).append("svg").attr("width",r+Wt.left+Wt.right).attr("height",a+Wt.top+Wt.bottom).append("g").attr("transform","translate(".concat(Wt.left,", ").concat(Wt.top,")"));var c=Object(Ce.n)(e).select("svg"),l=c.node(),u=c.select("g").node(),f=Object(Ce.k)().range([0,r]).domain(t),d=Object(Ce.l)().range([a,0]).domain(n);s({svg:l,g:u,height:a,width:r,margin:Wt}),v({x:f,y:d})}()}),[]),r.useEffect((function(){m&&t&&0===m.x.domain().length&&(m.x.domain(t),h())}),[t]),r.useEffect((function(){m&&n&&(m.y.domain(n).nice(),h())}),[n]),r.createElement(r.Fragment,null,r.createElement(Bt,{headerHeight:25,ref:i}),r.Children.map(a,(function(e){return r.cloneElement(e,{svgContainerData:u,scales:m})})))},Vt={Precipitation:W,Runoff:U,Evapotranspiration:U,"Soil Moisture":H,Snowpack:V,"Change in Storage":"#333333"},Ut=function(e){var t=e.data,n=e.activeLayer,a=e.index4SelectedMonth,i=e.svgContainerData,o=e.scales,c=r.useRef(),l=function(){var e=Object(Ce.n)(c.current),r=o.x,i=o.y,l=Object(Ce.g)().curve(Ce.d).x((function(e){return r(e.date.getFullYear())+r.bandwidth()/2})).y((function(e){return i(e.value)}));u(),e.append("g").attr("class","monthly-trend-line-group").selectAll("path").data(t).join("path").attr("class","monthly-trend-line").attr("d",(function(e){return l(e)})).style("fill","none").style("stroke",(function(e){return Vt[n]})).style("stroke-width",(function(e,t){return t===a?2:.5})).style("opacity",(function(e,t){return t===a?1:.3}))},u=function(){var e=Object(Ce.n)(c.current).selectAll(".".concat("monthly-trend-line-group"));e.size()&&e.remove().exit()};return r.useEffect((function(){var e;i&&(e=i.g,c.current=Object(Ce.n)(e).append("g").node())}),[i]),r.useEffect((function(){i&&o&&t&&l()}),[o]),r.useEffect((function(){i&&o&&(t?l():u())}),[t]),null},qt=function(e){var t=e.svgContainerData,n=e.scales,a=e.onHover,i=r.useRef(),o=r.useRef(),c=function(e){o.current=e,l(),a(e)},l=function(){var e=n.x,t=o.current,r=Object(Ce.n)(i.current).select(".".concat("monthly-trend-vertical-ref-line")),a=t?e(t.value)+e.bandwidth()/2:0,c=t?1:0;r.attr("x1",a).attr("x2",a).style("opacity",c)},u=function(e){for(var t=-1,r=n.x,a=r.domain(),i=0,o=a.length;i<o;i++){var c=r(a[i]),l=a[i+1]?i+1:i,u=r(a[l]);if(e>=c&&e<=u){t=Math.abs(e-c)<Math.abs(e-u)?i:l;break}}return t>-1?{itemIndex:t,value:a[t]}:void 0};return r.useEffect((function(){t&&n&&!i.current&&function(){var e=t.g,n=t.height,r=t.width;i.current=Object(Ce.n)(e).append("g").node();var a=Object(Ce.n)(i.current);a.append("line").attr("class","monthly-trend-vertical-ref-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",n).style("opacity",0).attr("stroke-width",.5).attr("stroke","rgba(0,0,0,.7)").style("fill","none"),a.append("rect").attr("width",r).attr("height",n).attr("fill","rgba(0,0,0,0)").on("mouseleave",(function(){c(void 0)})).on("mousemove",(function(){var e=Object(Ce.j)(this)[0];u(e),c(u(e))}))}()}),[t,n]),null},Yt=function(e){var t=e.svgContainerData,n=e.scales,a=e.itemOnHover,i=e.data,o=e.selectedDate,c=r.useRef(),l=r.useState({top:0,left:0}),u=d()(l,2),s=u[0],f=u[1];return r.useEffect((function(){!function(){var e=c.current;if(e){var r=t.width,i=t.margin,o=n.x,l=e.offsetWidth,u=-(e.offsetHeight-i.top-25),s=o(a.value)+o.bandwidth()/2+i.left,d=s+l>=r+i.left?s-l:s;f({top:u,left:d})}}()}),[a]),a?function(){if(!a)return null;var e=s.top,t=s.left,n=a.itemIndex,l=a.value,u=o.getMonth(),f="".concat(Object(Ie.a)(o,"MMM")," ").concat(l);return i[u][n]?r.createElement("div",{ref:c,className:"font-size--3",style:{position:"absolute",left:"".concat(t,"px"),top:"".concat(e,"px"),padding:".15rem .35rem",background:"rgba(0,0,0,.7)",color:"#fff"}},r.createElement("span",null,f,": "),r.createElement("span",null,i[u][n].value," mm ")):null}():null};function Jt(){var e=te()(["\n    position: relative;\n    flex-grow: 0;\n    flex-shrink: 0;\n    width: 375px;\n    height: 100%;\n"]);return Jt=function(){return e},e}var Xt=ne.default.div(Jt()),Kt=function(e){var t=e.data,n=e.activeLayer,a=e.timeExtentItem,i=r.useState(),o=d()(i,2),c=o[0],l=o[1],u=Pe(),s=function(){return t?t[n]:null};return d()(u,1)[0]>=1200?r.createElement(Xt,null,r.createElement(Tt,{activeLayer:n,timeExtentItem:a}),r.createElement(Ht,{xDomain:t?t[n][0].map((function(e){return e.date.getFullYear()})):[],yDomain:function(){if(!t)return null;var e=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return t[n].forEach((function(t){var n=t.map((function(e){return e.value})),a=Object(Ce.h)(n),i=Object(Ce.i)(n);e=a>e?a:e,r=i<r?i:r})),[r,e]}()},r.createElement(Ut,{data:s(),activeLayer:n,index4SelectedMonth:a?a.date.getMonth():-1}),r.createElement(zt,null),r.createElement(Yt,{data:s(),itemOnHover:c,selectedDate:null==a?void 0:a.date}),r.createElement(qt,{onHover:l}))):null},Qt=function(e){var t=e.geometry,n=e.mapView,a=function(){var e=s()(l.a.mark((function e(){var r,a,i,o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Q.loadModules)(["esri/Graphic","esri/symbols/SimpleMarkerSymbol"]);case 3:r=e.sent,a=d()(r,2),i=a[0],o=a[1],c=new i({geometry:t,symbol:new o({style:"circle",color:J,size:"12px",outline:{color:X,width:2}})}),n.graphics.removeAll(),n.graphics.add(c),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return r.useEffect((function(){n&&t&&a()}),[t]),null},Zt=n(181),$t=n.n(Zt),en=n(108),tn=n.n(en),nn=document.createElement("div"),rn=function(e){var t=e.isOpen,n=e.onClose;return(r.createElement($t.a,{appElement:nn,open:t,title:"About this app",actions:[r.createElement(tn.a,{key:"cancel",halo:!0,onClick:n},"Close")]},r.createElement("div",{className:"font-size--1"},r.createElement("p",null,"This app is based on data from NASA’s ",r.createElement("a",{href:"https://ldas.gsfc.nasa.gov/",target:"_blank"},"Global Land Data Assimilation System")," (GLDAS-2.1), which uses weather observations like temperature, humidity, and rainfall to run the ",r.createElement("a",{href:"https://www.jsg.utexas.edu/noah-mp",target:"_blank"},"Noah")," land surface model. This model estimates how much of the rain becomes runoff, how much evaporates, and how much infiltrates into the soil. These output variables, calculated every three hours, are aggregated into monthly averages, giving us a record of the hydrologic cycle going all the way back to January 2000. "),r.createElement("p",null,"Soil moisture plus snowpack is the water storage at any given place. Every month that storage volume changes according to the water flux - recharge occurs when precipitation is high, depletion occurs when evapotranspiration and runoff are higher. "),r.createElement("p",null,"Click anywhere on the map to see how a chosen variable has changed over time, and click anywhere on the graph to switch the map to that month of interest. The water balance panel (on the left) shows how much recharge or depletion occurred during your chosen month, and how this compares to what’s normal. The trend analyzer panel (on the right) shows how your chosen variable was different in the same month during other years. "),r.createElement("p",null,"Because the model is run with 0.25 degree spatial resolution (~30 km), these data should only be used for regional analysis. A specific farm or other small area might experience very different conditions than the region around it, especially because human influences like irrigation are not included."))))},an=n(43),on=n.n(an),cn=function(e){return e.isVisible?r.createElement("div",{style:{bottom:0}},r.createElement(on.a,{yellow:!0,showIcon:!0},r.createElement(an.AlertMessage,null,"Run this app on your devices with wider screen to see the interactive components"))):null},ln=function(e){var t=e.isVisible,n=e.onClose;return t?r.createElement("div",{style:{position:"absolute",bottom:"1.5rem",right:"1rem"}},r.createElement(on.a,{red:!0,showIcon:!0,showCloseLabel:!0,onClose:n},r.createElement(an.AlertTitle,null,"No Data Found!"),r.createElement(an.AlertMessage,null,"Cannot find any GLDAS data for the selected location. Use a different location and try again."))):null};a.render(r.createElement(o.a,null,r.createElement(R,null,r.createElement(K,null))),document.getElementById("root"))}});